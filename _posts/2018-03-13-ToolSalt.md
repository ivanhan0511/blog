---
layout: post
title: Salt
---

To make some tools in SaltStack with Python

### Deployment
#### Install salt on Ubuntu Server 16.04.3 LTS
- Default version 2015.x.x -> Python2.7

- Upgrade to 2017.7.4 version -> Python3

#### Configuration
**TODO:**


### Upgrade
Upgrade salt-master and minions with salt2017.7.4
https://repo.saltstack.com/

#### Bootstrap - Multi-Platform
Salt Bootstrap is a shell script that detects the target platform and selects the best installation method. (Supported Platforms)
- On the Salt master
  Run these commands on the system that you want to use as the central management point.
  ```shell
  curl -L https://bootstrap.saltstack.com -o install_salt.sh
  sudo sh install_salt.sh -P -M
  ```

  Your Salt master can manage itself, so a Salt minion is installed along with the 
  Salt master. If you do not want to install the minion, also pass the `-N` option.

- On each Salt minion
  Run these commands on each system that you want to manage using Salt.
  ```shell
  curl -L https://bootstrap.saltstack.com -o install_salt.sh
  sudo sh install_salt.sh -P
  ```




### Parse data
#### CPU, Mem, Hostname and Disk usage
As below, this is only for a case that both master and minion are Linux.
And this is not extensible.
```shell
salt '*' grains.item num_cpus mem_total localhost > minfo
python salt_2_cpu_mem_host.py
```

So, use `disk.usage` is more common.
```shell
python salt_1_hardware.py
```


